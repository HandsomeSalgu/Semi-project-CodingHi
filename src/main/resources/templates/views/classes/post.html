<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" href="/css/classes/post.css"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
</head>
<body>
    <section>
        <div class="top-box">
            <div class="top-text">
                <p>[[${chapter.cgName}]] CHAPTER[[${chapter.chapNo}]]</p>
                <p>[[${chapter.chapTitle}]]</p>
            </div>
        </div>

        <div class="middle-box">
            <span class="middle-text-right">
                <p>조회수 [[${chapter.views}]]</p>
            </span>
            <span class="middle-text-left">
                <p>[[${chapter.updateDate}]]</p>
            </span>
            
        </div>

        <div class="bottom-box">
            <div class="bottom-content">
                <p>[[${chapter.chapDetail}]]</p>
            </div>
            <hr>
            <div class="bottom-option">
                <div class="bottom-option-grade">
                    <p>강의가 마음에 드셨나요?</p>
                    <div class="rating">
					    <span class="rating__result"></span> 
					    <i class="rating__star far fa-star"></i>
					    <i class="rating__star far fa-star"></i>
					    <i class="rating__star far fa-star"></i>
					    <i class="rating__star far fa-star"></i>
					    <i class="rating__star far fa-star"></i>
					</div>
                </div>
                <div class="bottom-option-menu">
                    <button class="class-list" id="classList" onclick="javascript:history.back();">목록</button>
                </div>
                <div class="bottom-option-update">
                	<th:block th:if="${session.loginUser != null && session.loginUser.admin == 'Y'}">
                    <img src="/photo/classes/update.png" class="image-bookmark"/>
                    <img src="/photo/classes/delete.png" class="image-bookmark"/>
                    </th:block>
                </div>
            </div>     
        </div>
    </section>
    
    <script>
    
    const ratingStars = [...document.getElementsByClassName("rating__star")];
    const ratingResult = document.querySelector(".rating__result");
    

    printRatingResult(ratingResult);

    function executeRating(stars, result) {
       const starClassActive = "rating__star fas fa-star";	 // 활성화된 별 클래스
       const starClassUnactive = "rating__star far fa-star"; // 비활성화된 별 클래스
       const starsLength = stars.length;					 // 별의 총 개수
       let i;
       stars.map((star) => {
          star.onclick = () => {	// 별을 클릭했을 때 실행
             i = stars.indexOf(star);	// 클릭한 별의 인덱스 가져오기
             
             if (star.className.indexOf(starClassUnactive) !== -1) {
            	// 비활성화된 별을 클릭한 경우
                printRatingResult(result, i + 1); // 점수 표시
                for (i; i >= 0; --i) stars[i].className = starClassActive; // 클릭한 별까지 활성화
             } else {
            	// 활성화된 별을 클릭한 경우
            	i += 1;
                printRatingResult(result, i);	// 점수 업데이트
                for (i; i < starsLength; ++i) stars[i].className = starClassUnactive; // 클릭한 별 이후 모두 비활성화
             }
             
             console.log(ratingResult);
             const rating = ratingResult.innerHTML.substr(0,1);
             
             if(confirm(rating + "점을 주시겠습니까?")){
            	console.log(ratingResult); 
             }else{
           		
             }
             
          };
       });
    }

    function printRatingResult(result, num = 0) {
       result.textContent = `${num}/5`;
    }
    
    executeRating(ratingStars, ratingResult);
    
    </script>
    
    
    
    <!--
    <script th:inline="javascript">
    	window.onload= ()=>{
        	const yellow = "invert(50%) sepia(10%) saturate(3000%) hue-rotate(1deg) brightness(111%) contrast(833%)";
        	const totalGrade = document.getElementsByClassName("grade-list");
        	console.log(totalGrade)
    	}

    	
    	
    </script>
      -->
</html>